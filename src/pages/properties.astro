---
import Button from '../components/button';
import MainLayout from '../layouts/main-layout.astro';
import { properties } from '../data/properties';

---

<MainLayout title='Properties'>

  <!-- Banner Section -->
  <section class="w-full bg-about h-[50vh] flex justify-center items-end">
    <div class="py-[30px] lg:py-[41px] px-[40px] lg:px-[100px] flex flex-col justify-center items-center bg-white rounded-tl-[37px] rounded-tr-[37px] gap-2.5">
      <h1 class="text-[30px] leading-[40px] lg:text-[50px] lg:leading-[62px] font-dm capitalize text-primary-200">Properties</h1>
      <p class="text-base lg:text-[22px] lg:leading-[33px] tracking-tight font-jost text-text-gray"><a href="/">Home</a> / Properties</p>
    </div>
  </section>

  <!-- Property Sections -->
  {properties.map((property, propertyIndex) => (
    <section class="w-full pt-[100px] lg:pt-[150px] px-2 lg:px-4 mx-auto lg:max-w-[1200px]"> 
      <div class="w-full flex flex-col-reverse lg:flex-row justify-between gap-10 items-center">
        <div class="flex flex-col lg:w-1/3"> 
          <h2 class="text-[30px] text-center lg:text-left font-dm tracking-wide capitalize leading-8 md:leading-[62.50px] md:text-[50px] text-text-blue">
            {property.title}
          </h2>
          <p class="text-base md:text-[22px] lg:max-w-[100%] text-center lg:text-left tracking-tight font-jost text-text-gray leading-[33px]">
            {property.description}
          </p>
          <Button text={property.buttonText} to="/booking" />
        </div>

        <div class="relative w-full lg:w-2/3 overflow-hidden">
          <div id={`carousel-${propertyIndex}`} class="carousel flex transition-transform duration-700 ease-out">
            {property.images.map((image, index) => (
              <img src={image} alt={`Imagen ${index + 1}`} class="w-[800px] h-[500px] flex-shrink-0 rounded-lg" />
            ))}
          </div>
          <button id={`prev-${propertyIndex}`} class="carousel-prev absolute top-1/2 left-4 transform -translate-y-1/2 bg-white p-2 rounded-full shadow-md">❮</button>
          <button id={`next-${propertyIndex}`} class="carousel-next absolute top-1/2 right-4 transform -translate-y-1/2 bg-white p-2 rounded-full shadow-md">❯</button>
        </div>
      </div>
    </section>
  ))}

  <script>
  document.addEventListener('DOMContentLoaded', () => {
    const carousels = document.querySelectorAll('.carousel');
    carousels.forEach((carousel, index) => {
      const images = carousel.children;
      let currentIndex = 0;

      const nextButton = document.getElementById(`next-${index}`);
      const prevButton = document.getElementById(`prev-${index}`);

      if (nextButton) {
        nextButton.addEventListener('click', () => {
          currentIndex = (currentIndex + 1) % images.length;
          updateCarousel(carousel, currentIndex);
        });
      }

      if (prevButton) {
        prevButton.addEventListener('click', () => {
          currentIndex = (currentIndex - 1 + images.length) % images.length;
          updateCarousel(carousel, currentIndex);
        });
      }
    });

    function updateCarousel(carousel: any, currentIndex: number) {
      const offset = -currentIndex * 100;
      carousel.style.transform = `translateX(${offset}%)`;
    }
  });
  </script>

</MainLayout>

<style>
  .no-scrollbar::-webkit-scrollbar {
    display: none;
  }
  .no-scrollbar {
    -ms-overflow-style: none;  
    scrollbar-width: none;  
  }
</style>
